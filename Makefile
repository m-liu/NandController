### Makefile for the nand_phy project
### Generated by Bluespec Workstation on Tue Jul 15 01:50:13 EDT 2014

#FPGA_FLAGS = -D FPGA_TARGET
#NAND_FLAGS = -D SLC_NAND
NAND_FLAGS =
FPGA_FLAGS = 
SIM_FLAGS = -D NAND_SIM
BSC_FLAGS = -keep-fires -aggressive-conditions
TOP_MODULE = mkTopArtix
TOP_PATH = src/TopArtix.bsv
TOP_TB_MODULE = mkTopTB
TOP_TB_PATH = src/TopTB.bsv

default: full_clean compile
sim: full_clean compile_sim
tb: full_clean compile_tb
tb_sim: full_clean compile_tb_sim

.PHONY: compile
compile:
	@echo Compiling $(TOP_MODULE)...
	bsc -u -verilog -elab -vdir verilog -bdir bscOut -info-dir bscOut $(BSC_FLAGS) $(FPGA_FLAGS) $(NAND_FLAGS) -p .:%/Prelude:%/Libraries:./src:./src/ECC/src_bsv -g $(TOP_MODULE)  $(TOP_PATH)
	@echo Compilation finished $(TOP_MODULE)

.PHONY: compile_sim
compile_sim:
	@echo Compiling SIMULATION ONLY $(TOP_MODULE)... 
	bsc -u -verilog -elab -vdir verilog -bdir bscOut -info-dir bscOut $(BSC_FLAGS) $(SIM_FLAGS) $(NAND_FLAGS) -p .:%/Prelude:%/Libraries:./src:./src/ECC/src_bsv -g $(TOP_MODULE)  $(TOP_PATH)
	@echo Compilation SIMULATION ONLY finished $(TOP_MODULE)

.PHONY: compile_tb
compile_tb:
	@echo Compiling $(TOP_TB_MODULE) ...
	bsc -u -verilog -elab -vdir verilog -bdir bscOut -info-dir bscOut $(BSC_FLAGS) $(FPGA_FLAGS) $(NAND_FLAGS) -p .:%/Prelude:%/Libraries:./src:./src/ECC/src_bsv -g $(TOP_TB_MODULE)  $(TOP_TB_PATH)
	@echo Compilation finished for $(TOP_TB_MODULE)

.PHONY: compile_tb_sim
compile_tb_sim:
	@echo Compiling SIMULATION ONLY $(TOP_TB_MODULE)...
	bsc -u -verilog -elab -vdir verilog -bdir bscOut -info-dir bscOut $(BSC_FLAGS) $(SIM_FLAGS) $(NAND_FLAGS) -p .:%/Prelude:%/Libraries:./src:./src/ECC/src_bsv -g $(TOP_TB_MODULE)  $(TOP_TB_PATH)
	@echo Compilation SIMULATION ONLY finished for $(TOP_TB_MODULE)




.PHONY: clean
clean:
	exec rm -f bscOut/*

.PHONY: full_clean
full_clean:
	rm -f bscOut/*
	rm -f verilog/*

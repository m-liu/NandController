### Makefile for the AAA_project project
### Generated by Bluespec Workstation on Wed Oct 12 13:03:11 EDT 2011

default: full_clean compile link simulate

encoder: full_clean compile_encoder link_encoder simulate

.PHONY: compile_encoder
compile_encoder:
	@echo Compiling encoder...
	bsc -u -sim -simdir simdir -bdir bdir -info-dir info-dir -aggressive-conditions -p .:%/Prelude:%/Libraries:./src_bsv:./src_c -g mkTestBenchEncoder  src_bsv/mkTestBenchEncoder.bsv 
	@echo Compilation finished

.PHONY: link_encoder
link_encoder:
	@echo Linking...
	bsc -e mkTestBenchEncoder -sim -o ./out -simdir simdir -p bdir:.:%/Prelude:%/Libraries:./src_bsv:./src_c -aggressive-conditions src_c/file_interface.cpp 
	@echo Linking finished

.PHONY: compile
compile:
	@echo Compiling...
	bsc -u -sim -simdir simdir -bdir bdir -info-dir info-dir -aggressive-conditions -p .:%/Prelude:%/Libraries:./src_bsv:./src_c -g mkTestBench  src_bsv/mkTestBench.bsv 
	@echo Compilation finished

.PHONY: link
link:
	@echo Linking...
	bsc -e mkTestBench -sim -o ./out -simdir simdir -p bdir:.:%/Prelude:%/Libraries:./src_bsv:./src_c -aggressive-conditions src_c/file_interface.cpp 
	@echo Linking finished

.PHONY: simulate
simulate:
	@echo Simulation...
	./out 2>&1 | tee LOG
	@echo Simulation finished

.PHONY: sim
sim:
	./out > transcript.txt
	ls -als  ../MIT/output.dat  ./output.dat
	diff -q  ../MIT/output.dat  ./output.dat
	tail  ../MIT/transcript.txt
	tail  ./transcript.txt

.PHONY: clean
clean:
	exec rm -f bdir/Berlekamp.bo bdir/ChienSearch.bo bdir/ErrorCorrector.bo bdir/ErrorMagnitude.bo bdir/GFArith.bo bdir/GFTypes.bo bdir/MFIFO.bo bdir/mkReedSolomon.bo bdir/mkTestBench.bo bdir/PAClib.bo bdir/Syndrome.bo
	exec rm -f bdir/Berlekamp.bi bdir/ChienSearch.bi bdir/ErrorCorrector.bi bdir/ErrorMagnitude.bi bdir/GFArith.bi bdir/GFTypes.bi bdir/MFIFO.bi bdir/mkReedSolomon.bi bdir/mkTestBench.bi bdir/PAClib.bi bdir/Syndrome.bi
	exec rm -f bdir/closeOutputFile.ba bdir/getNextStreamByte.ba bdir/isStreamActive.ba bdir/loadByteStream.ba bdir/mkBerlekamp.ba bdir/mkChienSearch.ba bdir/mkErrorCorrector.ba bdir/mkErrorMagnitude.ba bdir/mkReedSolomon.ba bdir/mkTestBench.ba bdir/module_gf_add_inst.ba bdir/module_gf_mult_inst.ba bdir/module_times_alpha_n_v.ba bdir/putMACData.ba bdir/putNextStreamByte.ba bdir/storeByteStream.ba

.PHONY: full_clean
full_clean:
	rm -f bdir/Berlekamp.bo bdir/ChienSearch.bo bdir/ErrorCorrector.bo bdir/ErrorMagnitude.bo bdir/GFArith.bo bdir/GFTypes.bo bdir/MFIFO.bo bdir/mkReedSolomon.bo bdir/mkTestBench.bo bdir/PAClib.bo bdir/Syndrome.bo
	rm -f bdir/Berlekamp.bi bdir/ChienSearch.bi bdir/ErrorCorrector.bi bdir/ErrorMagnitude.bi bdir/GFArith.bi bdir/GFTypes.bi bdir/MFIFO.bi bdir/mkReedSolomon.bi bdir/mkTestBench.bi bdir/PAClib.bi bdir/Syndrome.bi
	rm -f bdir/closeOutputFile.ba bdir/getNextStreamByte.ba bdir/isStreamActive.ba bdir/loadByteStream.ba bdir/mkBerlekamp.ba bdir/mkChienSearch.ba bdir/mkErrorCorrector.ba bdir/mkErrorMagnitude.ba bdir/mkReedSolomon.ba bdir/mkTestBench.ba bdir/module_gf_add_inst.ba bdir/module_gf_mult_inst.ba bdir/module_times_alpha_n_v.ba bdir/putMACData.ba bdir/putNextStreamByte.ba bdir/storeByteStream.ba
	rm -f simdir/mkBerlekamp.h
	rm -f simdir/mkBerlekamp.cxx
	rm -f simdir/mkChienSearch.h
	rm -f simdir/mkChienSearch.cxx
	rm -f simdir/mkErrorCorrector.h
	rm -f simdir/mkErrorCorrector.cxx
	rm -f simdir/mkErrorMagnitude.h
	rm -f simdir/mkErrorMagnitude.cxx
	rm -f simdir/mkReedSolomon.h
	rm -f simdir/mkReedSolomon.cxx
	rm -f simdir/mkTestBench.h
	rm -f simdir/mkTestBench.cxx
	rm -f simdir/module_gf_add_inst.h
	rm -f simdir/module_gf_add_inst.cxx
	rm -f simdir/module_gf_mult_inst.h
	rm -f simdir/module_gf_mult_inst.cxx
	rm -f simdir/module_times_alpha_n_v.h
	rm -f simdir/module_times_alpha_n_v.cxx
	rm -rf simdir/*
	rm -rf bdir/*
